<!DOCTYPE html>
<html lang="fr" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√©ances de sport</title>
    <style>
        :root {
            --bg: #ffffff;
            --fg: #000000;
            --card: #f0f0f0;
            --accent: #007aff;
        }
        [data-theme="dark"] {
            --bg: #1d1d1f;
            --fg: #ffffff;
            --card: #2c2c2e;
            --accent: #0a84ff;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif;
            background: var(--bg);
            color: var(--fg);
            margin: 0;
            min-height: 100vh;
            padding-bottom: 60px;
        }
        h1 { text-align:center; margin:16px 0; position:relative; }
        #toggle-theme { position:absolute; right:16px; top:0; background:transparent; border:none; font-size:1.2em; }
        #controls { text-align:center; margin-bottom:20px; }
        #list { width:95%; max-width:500px; margin:0 auto; }
        .session { display:flex; align-items:center; background:var(--card); margin:4px 0; padding:8px 12px; border-radius:10px; }
        .session.done { background:#4caf50; color:#fff; }
        .session span { flex:1; }
        dialog form { display:flex; flex-direction:column; gap:8px; }
        .bottom-nav { position:fixed; bottom:0; left:0; right:0; background:var(--card); display:flex; justify-content:space-around; padding:8px 0; border-top:1px solid #aaa; }
        .bottom-nav a { color:var(--fg); text-decoration:none; font-size:1.4em; }
    </style>
</head>
<body>
<h1>S√©ances de sport <button id="toggle-theme">üåô</button></h1>
<div id="controls">
    <button id="add">Ajouter une s√©ance</button>
</div>
<div id="list"></div>
<dialog id="modal">
    <form id="form">
        <label>Date: <input type="date" id="date" required></label>
        <label>Sport: <input type="text" id="sport" required></label>
        <label>D√©tail:<br><textarea id="detail"></textarea></label>
        <div>
            <button type="submit">Enregistrer</button>
            <button type="button" id="cancel">Annuler</button>
        </div>
    </form>
</dialog>
<nav class="bottom-nav">
    <a href="index.html">üè†</a>
    <a href="sport.html">‚öΩ</a>
    <a href="stats.html">üìä</a>
</nav>
<script>
const categories = {
    "Sant√©": [
        "Sport",
        "Petit d√©jeuner √©quilibr√©",
        "D√©jeuner √©quilibr√©",
        "D√Æner √©quilibr√©",
        "Pas de grignotage"
    ],
    "R√©seaux sociaux": [
        "Post Tiktok lolo.puzzle",
        "Post Tiktok LBB",
        "Post Tiktok mymy.puzzle",
        "Post Tiktok footballteamlogocircle",
        "Post Tiktok kanoodle_addict",
        "Post Tiktok kanoodle_experience",
        "Post Instagram LBB",
        "Post Instagram bretagnifique",
        "Post Instagram lolo.puzzle"
    ],
    "Formation": [
        "Formation Anglais",
        "Formation Codex / ChatGPT"
    ],
    "Autre": [
        "Lire 15 min",
        "Regarder un √©pisode s√©rie",
        "T√¢che m√©nag√®re",
        "Jouer avec les enfants"
    ]
};
const tasks = Object.values(categories).flat();
const sportIndex = tasks.indexOf('Sport');
function initTheme(){
    const th=localStorage.getItem('theme')||'dark';
    document.documentElement.setAttribute('data-theme',th);
    document.getElementById('toggle-theme').textContent = th==='dark'?'üåô':'‚òÄÔ∏è';
}
function loadSessions(){
    return JSON.parse(localStorage.getItem('sport_sessions')||'[]');
}
function saveSessions(s){
    localStorage.setItem('sport_sessions',JSON.stringify(s));
}
function render(){
    const list=document.getElementById('list');
    const sessions=loadSessions().sort((a,b)=>new Date(a.date)-new Date(b.date));
    list.innerHTML='';
    const today=new Date().toISOString().split('T')[0];
    sessions.forEach((s,idx)=>{
        const div=document.createElement('div');
        div.className='session';
        if(new Date(s.date)<=new Date()){
            const st=JSON.parse(localStorage.getItem('tasks_'+s.date)||'[]');
            if(st[sportIndex]) div.classList.add('done');
        }
        const date=document.createElement('span');
        date.textContent=s.date;
        const sport=document.createElement('span');
        sport.textContent=s.sport;
        const detail=document.createElement('span');
        detail.textContent=s.detail;
        const edit=document.createElement('button');
        edit.textContent='‚úèÔ∏è';
        edit.addEventListener('click',()=>openModal(idx));
        const del=document.createElement('button');
        del.textContent='üóëÔ∏è';
        del.addEventListener('click',()=>{if(confirm('Supprimer ?')){const ss=loadSessions();ss.splice(idx,1);saveSessions(ss);render();}});
        div.appendChild(date);div.appendChild(sport);div.appendChild(detail);div.appendChild(edit);div.appendChild(del);
        list.appendChild(div);
    });
}
function openModal(idx){
    const modal=document.getElementById('modal');
    const form=document.getElementById('form');
    const sessions=loadSessions();
    if(idx!=null){
        const s=sessions[idx];
        form.dataset.idx=idx;
        document.getElementById('date').value=s.date;
        document.getElementById('sport').value=s.sport;
        document.getElementById('detail').value=s.detail;
    }else{
        delete form.dataset.idx;
        document.getElementById('date').value=new Date().toISOString().split('T')[0];
        document.getElementById('sport').value='';
        document.getElementById('detail').value='';
    }
    modal.showModal();
}
document.getElementById('add').addEventListener('click',()=>openModal());
document.getElementById('cancel').addEventListener('click',()=>document.getElementById('modal').close());
document.getElementById('form').addEventListener('submit',e=>{
    e.preventDefault();
    const sessions=loadSessions();
    const idx=e.target.dataset.idx;
    const data={date:document.getElementById('date').value,sport:document.getElementById('sport').value,detail:document.getElementById('detail').value};
    if(idx!=null){sessions[idx]=data;}else{sessions.push(data);}
    saveSessions(sessions);document.getElementById('modal').close();render();
});
document.getElementById('toggle-theme').addEventListener('click',()=>{
    const current=document.documentElement.getAttribute('data-theme');
    const next=current==='dark'?'light':'dark';
    document.documentElement.setAttribute('data-theme',next);
    localStorage.setItem('theme',next);
    document.getElementById('toggle-theme').textContent = next==='dark'?'üåô':'‚òÄÔ∏è';
});
initTheme();
render();
</script>
</body>
</html>
